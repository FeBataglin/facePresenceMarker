import { __decorate, __metadata } from "tslib";
import { Component, Input } from '@angular/core';
import { DatePipe } from '@angular/common';
import { PoInfoOrientation } from '@po-ui/ng-components';
let PoPageJobSchedulerSummaryComponent = class PoPageJobSchedulerSummaryComponent {
    constructor(datePipe) {
        this.datePipe = datePipe;
        this.executionValue = '';
        this.firstExecutionValue = '';
        this.infoOrientation = PoInfoOrientation.Horizontal;
        this.periodicityValue = '';
        this.recurrentValue = '';
        this.literals = {};
        this.parameters = [];
        this.value = {};
    }
    ngOnInit() {
        const { periodicity, hour, dayOfMonth, daysOfWeek, recurrent, firstExecution, firstExecutionHour } = this.value;
        this.periodicityValue = this.getPeriodicityLabel(periodicity);
        this.executionValue = this.getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth);
        this.firstExecutionValue = this.getFirstExecutionLabel(firstExecution, firstExecutionHour);
        this.recurrentValue = this.getRecurrentValue(recurrent);
    }
    getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth) {
        switch (periodicity) {
            case 'daily':
                return this.getHourLabel(hour);
            case 'monthly':
                return this.getMonthlyLabelExecution(dayOfMonth, hour);
            case 'weekly':
                return this.getWeeklyLabelExecution(daysOfWeek, hour);
            default:
                return this.literals.notReported;
        }
    }
    getFirstExecutionLabel(firstExecution, firstExecutionHour) {
        if (firstExecution) {
            const date = this.datePipe.transform(firstExecution, 'dd/MM/yyyy', '-0200');
            return `${date} ${this.getHourLabel(firstExecutionHour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    getHourLabel(hour) {
        return `${this.literals.at} ${hour || '00:00'}h`;
    }
    getMonthlyLabelExecution(dayOfMonth, hour) {
        const hourLabel = this.getHourLabel(hour);
        return `${this.literals.day} ${dayOfMonth} ${hourLabel}`;
    }
    getPeriodicityLabel(periodicity) {
        switch (periodicity) {
            case 'daily':
                return this.literals.daily;
            case 'monthly':
                return this.literals.monthly;
            case 'weekly':
                return this.literals.weekly;
            default:
                return this.literals.single;
        }
    }
    getRecurrentValue(recurrent) {
        return recurrent ? this.literals.yes : this.literals.no;
    }
    getSorterWeekDays() {
        return {
            'sunday': 0,
            'monday': 1,
            'tuesday': 2,
            'wednesday': 3,
            'thursday': 4,
            'friday': 5,
            'saturday': 6
        };
    }
    getTranslateWeekDay(day) {
        const days = {
            Sunday: this.literals.sunday,
            Monday: this.literals.monday,
            Tuesday: this.literals.tuesday,
            Wednesday: this.literals.wednesday,
            Thursday: this.literals.thursday,
            Friday: this.literals.friday,
            Saturday: this.literals.saturday
        };
        return days[day] || '';
    }
    getWeekDaysLabel(days = []) {
        const weekDaysSorted = this.sortWeekDays(days);
        return weekDaysSorted.map(day => this.getTranslateWeekDay(day)).join(', ');
    }
    getWeeklyLabelExecution(daysOfWeek, hour) {
        if (daysOfWeek && Array.isArray(daysOfWeek)) {
            return `${this.getWeekDaysLabel(daysOfWeek)} ${this.getHourLabel(hour)}`;
        }
        else {
            return this.literals.notReported;
        }
    }
    sortWeekDays(days = []) {
        const sorterWeekDays = this.getSorterWeekDays();
        return days.sort((a, b) => {
            const currDay = a.toLowerCase();
            const nextDay = b.toLowerCase();
            return sorterWeekDays[currDay] > sorterWeekDays[nextDay] ? 1 : -1;
        });
    }
};
PoPageJobSchedulerSummaryComponent.ctorParameters = () => [
    { type: DatePipe }
];
__decorate([
    Input('p-literals'),
    __metadata("design:type", Object)
], PoPageJobSchedulerSummaryComponent.prototype, "literals", void 0);
__decorate([
    Input('p-parameters'),
    __metadata("design:type", Array)
], PoPageJobSchedulerSummaryComponent.prototype, "parameters", void 0);
__decorate([
    Input('p-value'),
    __metadata("design:type", Object)
], PoPageJobSchedulerSummaryComponent.prototype, "value", void 0);
PoPageJobSchedulerSummaryComponent = __decorate([
    Component({
        selector: 'po-page-job-scheduler-summary',
        template: "<div class=\"po-md-12\">\n  <po-info [p-label]=\"literals.process\" [p-orientation]=\"infoOrientation\" [p-value]=\"value.processID\"> </po-info>\n\n  <po-info [p-label]=\"literals.periodicity\" [p-orientation]=\"infoOrientation\" [p-value]=\"periodicityValue\"> </po-info>\n\n  <po-info\n    *ngIf=\"value.periodicity !== 'single'\"\n    [p-label]=\"literals.execution\"\n    [p-orientation]=\"infoOrientation\"\n    [p-value]=\"executionValue\"\n  >\n  </po-info>\n\n  <po-info [p-label]=\"literals.recurrent\" [p-orientation]=\"infoOrientation\" [p-value]=\"recurrentValue\"> </po-info>\n\n  <po-info [p-label]=\"literals.firstExecution\" [p-orientation]=\"infoOrientation\" [p-value]=\"firstExecutionValue\">\n  </po-info>\n</div>\n\n<po-widget *ngIf=\"parameters && parameters.length\" class=\"po-pt-1 po-pb-1 po-md-12\" [p-title]=\"literals.parameters\">\n  <po-dynamic-view [p-fields]=\"parameters\" [p-value]=\"value.executionParameter\"> </po-dynamic-view>\n</po-widget>\n"
    }),
    __metadata("design:paramtypes", [DatePipe])
], PoPageJobSchedulerSummaryComponent);
export { PoPageJobSchedulerSummaryComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHBvLXVpL25nLXRlbXBsYXRlcy8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3BvLXBhZ2Utam9iLXNjaGVkdWxlci9wby1wYWdlLWpvYi1zY2hlZHVsZXItc3VtbWFyeS9wby1wYWdlLWpvYi1zY2hlZHVsZXItc3VtbWFyeS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUzQyxPQUFPLEVBQXNCLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFRN0UsSUFBYSxrQ0FBa0MsR0FBL0MsTUFBYSxrQ0FBa0M7SUFhN0MsWUFBb0IsUUFBa0I7UUFBbEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQVp0QyxtQkFBYyxHQUFHLEVBQUUsQ0FBQztRQUNwQix3QkFBbUIsR0FBRyxFQUFFLENBQUM7UUFDekIsb0JBQWUsR0FBRyxpQkFBaUIsQ0FBQyxVQUFVLENBQUM7UUFDL0MscUJBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLG1CQUFjLEdBQUcsRUFBRSxDQUFDO1FBRUMsYUFBUSxHQUFRLEVBQUUsQ0FBQztRQUVqQixlQUFVLEdBQThCLEVBQUUsQ0FBQztRQUVoRCxVQUFLLEdBQWdDLEVBQUUsQ0FBQztJQUVqQixDQUFDO0lBRTFDLFFBQVE7UUFDTixNQUFNLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBRWhILElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7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LENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxFQUFFO1lBQ3hDLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNoQyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFFaEMsT0FBTyxjQUFjLENBQUMsT0FBTyxDQUFDLEdBQUcsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGLENBQUE7O1lBL0crQixRQUFROztBQU5qQjtJQUFwQixLQUFLLENBQUMsWUFBWSxDQUFDOztvRUFBb0I7QUFFakI7SUFBdEIsS0FBSyxDQUFDLGNBQWMsQ0FBQzs4QkFBYSxLQUFLO3NFQUEwQjtBQUVoRDtJQUFqQixLQUFLLENBQUMsU0FBUyxDQUFDOztpRUFBeUM7QUFYL0Msa0NBQWtDO0lBSjlDLFNBQVMsQ0FBQztRQUNULFFBQVEsRUFBRSwrQkFBK0I7UUFDekMsaStCQUEyRDtLQUM1RCxDQUFDO3FDQWM4QixRQUFRO0dBYjNCLGtDQUFrQyxDQTRIOUM7U0E1SFksa0NBQWtDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBEYXRlUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmltcG9ydCB7IFBvRHluYW1pY1ZpZXdGaWVsZCwgUG9JbmZvT3JpZW50YXRpb24gfSBmcm9tICdAcG8tdWkvbmctY29tcG9uZW50cyc7XG5cbmltcG9ydCB7IFBvSm9iU2NoZWR1bGVySW50ZXJuYWwgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3BvLWpvYi1zY2hlZHVsZXItaW50ZXJuYWwuaW50ZXJmYWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncG8tcGFnZS1qb2Itc2NoZWR1bGVyLXN1bW1hcnknLFxuICB0ZW1wbGF0ZVVybDogJ3BvLXBhZ2Utam9iLXNjaGVkdWxlci1zdW1tYXJ5LmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBQb1BhZ2VKb2JTY2hlZHVsZXJTdW1tYXJ5Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgZXhlY3V0aW9uVmFsdWUgPSAnJztcbiAgZmlyc3RFeGVjdXRpb25WYWx1ZSA9ICcnO1xuICBpbmZvT3JpZW50YXRpb24gPSBQb0luZm9PcmllbnRhdGlvbi5Ib3Jpem9udGFsO1xuICBwZXJpb2RpY2l0eVZhbHVlID0gJyc7XG4gIHJlY3VycmVudFZhbHVlID0gJyc7XG5cbiAgQElucHV0KCdwLWxpdGVyYWxzJykgbGl0ZXJhbHMgPSA8YW55Pnt9O1xuXG4gIEBJbnB1dCgncC1wYXJhbWV0ZXJzJykgcGFyYW1ldGVyczogQXJyYXk8UG9EeW5hbWljVmlld0ZpZWxkPiA9IFtdO1xuXG4gIEBJbnB1dCgncC12YWx1ZScpIHZhbHVlOiBQb0pvYlNjaGVkdWxlckludGVybmFsID0gPGFueT57fTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGVQaXBlOiBEYXRlUGlwZSkge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICBjb25zdCB7IHBlcmlvZGljaXR5LCBob3VyLCBkYXlPZk1vbnRoLCBkYXlzT2ZXZWVrLCByZWN1cnJlbnQsIGZpcnN0RXhlY3V0aW9uLCBmaXJzdEV4ZWN1dGlvbkhvdXIgfSA9IHRoaXMudmFsdWU7XG5cbiAgICB0aGlzLnBlcmlvZGljaXR5VmFsdWUgPSB0aGlzLmdldFBlcmlvZGljaXR5TGFiZWwocGVyaW9kaWNpdHkpO1xuICAgIHRoaXMuZXhlY3V0aW9uVmFsdWUgPSB0aGlzLmdldEV4ZWN1dGlvblZhbHVlKHBlcmlvZGljaXR5LCBob3VyLCBkYXlzT2ZXZWVrLCBkYXlPZk1vbnRoKTtcbiAgICB0aGlzLmZpcnN0RXhlY3V0aW9uVmFsdWUgPSB0aGlzLmdldEZpcnN0RXhlY3V0aW9uTGFiZWwoZmlyc3RFeGVjdXRpb24sIGZpcnN0RXhlY3V0aW9uSG91cik7XG4gICAgdGhpcy5yZWN1cnJlbnRWYWx1ZSA9IHRoaXMuZ2V0UmVjdXJyZW50VmFsdWUocmVjdXJyZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RXhlY3V0aW9uVmFsdWUocGVyaW9kaWNpdHk6IHN0cmluZywgaG91cj86IHN0cmluZywgZGF5c09mV2Vlaz86IEFycmF5PHN0cmluZz4sIGRheU9mTW9udGg/OiBudW1iZXIpIHtcbiAgICBzd2l0Y2ggKHBlcmlvZGljaXR5KSB7XG4gICAgICBjYXNlICdkYWlseSc6XG4gICAgICAgIHJldHVybiB0aGlzLmdldEhvdXJMYWJlbChob3VyKTtcbiAgICAgIGNhc2UgJ21vbnRobHknOlxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNb250aGx5TGFiZWxFeGVjdXRpb24oZGF5T2ZNb250aCwgaG91cik7XG4gICAgICBjYXNlICd3ZWVrbHknOlxuICAgICAgICByZXR1cm4gdGhpcy5nZXRXZWVrbHlMYWJlbEV4ZWN1dGlvbihkYXlzT2ZXZWVrLCBob3VyKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLm5vdFJlcG9ydGVkO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0Rmlyc3RFeGVjdXRpb25MYWJlbChmaXJzdEV4ZWN1dGlvbjogRGF0ZSwgZmlyc3RFeGVjdXRpb25Ib3VyPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoZmlyc3RFeGVjdXRpb24pIHtcbiAgICAgIGNvbnN0IGRhdGUgPSB0aGlzLmRhdGVQaXBlLnRyYW5zZm9ybShmaXJzdEV4ZWN1dGlvbiwgJ2RkL01NL3l5eXknLCAnLTAyMDAnKTtcblxuICAgICAgcmV0dXJuIGAke2RhdGV9ICR7dGhpcy5nZXRIb3VyTGFiZWwoZmlyc3RFeGVjdXRpb25Ib3VyKX1gO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5ub3RSZXBvcnRlZDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEhvdXJMYWJlbChob3VyOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5saXRlcmFscy5hdH0gJHtob3VyIHx8ICcwMDowMCd9aGA7XG4gIH1cblxuICBwcml2YXRlIGdldE1vbnRobHlMYWJlbEV4ZWN1dGlvbihkYXlPZk1vbnRoOiBudW1iZXIsIGhvdXI6IHN0cmluZykge1xuICAgIGNvbnN0IGhvdXJMYWJlbCA9IHRoaXMuZ2V0SG91ckxhYmVsKGhvdXIpO1xuXG4gICAgcmV0dXJuIGAke3RoaXMubGl0ZXJhbHMuZGF5fSAke2RheU9mTW9udGh9ICR7aG91ckxhYmVsfWA7XG4gIH1cblxuICBwcml2YXRlIGdldFBlcmlvZGljaXR5TGFiZWwocGVyaW9kaWNpdHkpIHtcbiAgICBzd2l0Y2ggKHBlcmlvZGljaXR5KSB7XG4gICAgICBjYXNlICdkYWlseSc6XG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLmRhaWx5O1xuICAgICAgY2FzZSAnbW9udGhseSc6XG4gICAgICAgIHJldHVybiB0aGlzLmxpdGVyYWxzLm1vbnRobHk7XG4gICAgICBjYXNlICd3ZWVrbHknOlxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy53ZWVrbHk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdGhpcy5saXRlcmFscy5zaW5nbGU7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRSZWN1cnJlbnRWYWx1ZShyZWN1cnJlbnQ6IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgIHJldHVybiByZWN1cnJlbnQgPyB0aGlzLmxpdGVyYWxzLnllcyA6IHRoaXMubGl0ZXJhbHMubm87XG4gIH1cblxuICBwcml2YXRlIGdldFNvcnRlcldlZWtEYXlzKCkge1xuICAgIHJldHVybiB7XG4gICAgICAnc3VuZGF5JzogMCxcbiAgICAgICdtb25kYXknOiAxLFxuICAgICAgJ3R1ZXNkYXknOiAyLFxuICAgICAgJ3dlZG5lc2RheSc6IDMsXG4gICAgICAndGh1cnNkYXknOiA0LFxuICAgICAgJ2ZyaWRheSc6IDUsXG4gICAgICAnc2F0dXJkYXknOiA2XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VHJhbnNsYXRlV2Vla0RheShkYXk6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZGF5cyA9IHtcbiAgICAgIFN1bmRheTogdGhpcy5saXRlcmFscy5zdW5kYXksXG4gICAgICBNb25kYXk6IHRoaXMubGl0ZXJhbHMubW9uZGF5LFxuICAgICAgVHVlc2RheTogdGhpcy5saXRlcmFscy50dWVzZGF5LFxuICAgICAgV2VkbmVzZGF5OiB0aGlzLmxpdGVyYWxzLndlZG5lc2RheSxcbiAgICAgIFRodXJzZGF5OiB0aGlzLmxpdGVyYWxzLnRodXJzZGF5LFxuICAgICAgRnJpZGF5OiB0aGlzLmxpdGVyYWxzLmZyaWRheSxcbiAgICAgIFNhdHVyZGF5OiB0aGlzLmxpdGVyYWxzLnNhdHVyZGF5XG4gICAgfTtcblxuICAgIHJldHVybiBkYXlzW2RheV0gfHwgJyc7XG4gIH1cblxuICBwcml2YXRlIGdldFdlZWtEYXlzTGFiZWwoZGF5czogQXJyYXk8c3RyaW5nPiA9IFtdKTogc3RyaW5nIHtcbiAgICBjb25zdCB3ZWVrRGF5c1NvcnRlZCA9IHRoaXMuc29ydFdlZWtEYXlzKGRheXMpO1xuXG4gICAgcmV0dXJuIHdlZWtEYXlzU29ydGVkLm1hcChkYXkgPT4gdGhpcy5nZXRUcmFuc2xhdGVXZWVrRGF5KGRheSkpLmpvaW4oJywgJyk7XG4gIH1cblxuICBwcml2YXRlIGdldFdlZWtseUxhYmVsRXhlY3V0aW9uKGRheXNPZldlZWs6IEFycmF5PHN0cmluZz4sIGhvdXI6IHN0cmluZykge1xuICAgIGlmIChkYXlzT2ZXZWVrICYmIEFycmF5LmlzQXJyYXkoZGF5c09mV2VlaykpIHtcbiAgICAgIHJldHVybiBgJHt0aGlzLmdldFdlZWtEYXlzTGFiZWwoZGF5c09mV2Vlayl9ICR7dGhpcy5nZXRIb3VyTGFiZWwoaG91cil9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMubGl0ZXJhbHMubm90UmVwb3J0ZWQ7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzb3J0V2Vla0RheXMoZGF5czogQXJyYXk8c3RyaW5nPiA9IFtdKSB7XG4gICAgY29uc3Qgc29ydGVyV2Vla0RheXMgPSB0aGlzLmdldFNvcnRlcldlZWtEYXlzKCk7XG5cbiAgICByZXR1cm4gZGF5cy5zb3J0KChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgY3VyckRheSA9IGEudG9Mb3dlckNhc2UoKTtcbiAgICAgIGNvbnN0IG5leHREYXkgPSBiLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIHJldHVybiBzb3J0ZXJXZWVrRGF5c1tjdXJyRGF5XSA+IHNvcnRlcldlZWtEYXlzW25leHREYXldID8gMSA6IC0xO1xuICAgIH0pO1xuICB9XG59XG4iXX0=