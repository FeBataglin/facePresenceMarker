!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators"),require("rxjs/operators/map"),require("@po-ui/ng-components"),require("@angular/forms"),require("rxjs/internal/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("dts-backoffice-util",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators","rxjs/operators/map","@po-ui/ng-components","@angular/forms","rxjs/internal/operators","@angular/common"],t):t((e=e||self)["dts-backoffice-util"]={},e.ng.core,e.ng.common.http,e.rxjs,e.rxjs.operators,e.rxjs["operators/map"],e.ngComponents,e.ng.forms,e.rxjs["internal/operators"],e.ng.common)}(this,(function(e,t,r,n,o,i,a,l,p,s){"use strict";var u=function(){function e(e){this.http=e,this.apiUrl="/totvs-menu/rest/getSessionInfo",this.userLogin=void 0}return e.prototype.getUserLogin=function(){var e=this;return localStorage.getItem("username")?n.of(localStorage.getItem("username")):this.userLogin?n.of(this.userLogin):this.http.get(""+this.apiUrl).pipe(o.map((function(t){return e.userLogin=t.userName,t.userName})))},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.HttpClient}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.HttpClient))},token:e,providedIn:"root"}),e}();var c={STRING:1,JSON:2};c[c.STRING]="STRING",c[c.JSON]="JSON";var d=function(){function e(e){this.http=e,this.apiURL="/dts/datasul-rest/resources/api/btb/btapi930za"}return e.prototype.setProfile=function(e){var t=e.pageId,r=e.userCode;return this.http.post(this.apiURL+"/setProfile?userCode="+r+"&pageId="+t,e,{headers:{"X-PO-Screen-Lock":"true"}})},e.prototype.getProfileAsString=function(e,t){return this.getProfile(e,c.STRING,t?"true":"false")},e.prototype.getProfileAsJSON=function(e,t){return this.getProfile(e,c.JSON,t?"true":"false")},e.prototype.getProfile=function(e,t,r){var n={"X-PO-Screen-Lock":r},o=e.pageId,a=e.dataCode,l=e.userCode;return this.http.get(this.apiURL+"/getProfile?userCode="+l+"&pageId="+o+"&dataCode="+a,{headers:n}).pipe(i.map((function(e){if(e.data[0])return t===c.STRING?e.data[0].dataValue:t===c.JSON?JSON.parse(e.data[0].dataValue):void 0})))},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.HttpClient}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.HttpClient))},token:e,providedIn:"root"}),e}();var m=function(){function e(e){this.httpClient=e,this.URL=window.location.href.indexOf("totvs-menu")>0?"/totvs-menu/rest/report/run/":"/dts/datasul-report/resources/run/"}return e.prototype.generate=function(e,t){var r=this;void 0===t&&(t=!0);var n={"X-PO-Screen-Lock":t?"true":"false"},o=""+this.URL+e.reportName;return e.properties.length>0&&(o+="?",e.properties.forEach((function(e,t){t>0&&(o+="&"),o+="c_properties="+e.name+"&c_values="+e.value}))),o+="&dialect="+e.dialect+"&format="+e.format,o+="&program="+e.programName+"&resultFileName="+e.downloadName,this.httpClient.post(o,{},{headers:n,responseType:"blob"}).pipe(i.map((function(t){return e.download&&r.download(t,e.downloadName+"."+e.format),t})))},e.prototype.download=function(e,t){var r=[e],n=document.createElement("a"),o=window.URL.createObjectURL(new Blob(r,{type:e.type}));n.href=o,n.setAttribute("download",t),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(o),n.remove()},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:r.HttpClient}]},e}();var h=function(){function e(){}return e.prototype.newBreadcrumb=function(){this.breadcrumb={items:[]}},e.prototype.addBreadcrumb=function(e,t){this.addBreadcrumbURL(e,decodeURIComponent(t.snapshot._routerState.url))},e.prototype.addBreadcrumbURL=function(e,t){if(e&&""!==e){this.breadcrumb||this.newBreadcrumb();var r={items:[]},n=0;for(n=0;n<this.breadcrumb.items.length&&this.breadcrumb.items[n].label!==e;n++)r.items.push(this.breadcrumb.items[n]);r.items.push({label:e,link:t}),this.breadcrumb=r}},e.prototype.updBreadcrumbURL=function(e,t,r){var n=this.getCurrentRouter();n&&t&&r&&(n=n.replace(t,r),this.addBreadcrumbURL(e,n))},e.prototype.getBreadcrumb=function(){return this.breadcrumb||this.newBreadcrumb(),this.breadcrumb},e.prototype.getCurrentRouter=function(){return this.breadcrumb||this.newBreadcrumb(),this.breadcrumb.items.length<=0?"":this.breadcrumb.items[this.breadcrumb.items.length-1].link},e.prototype.getPrevRouter=function(){return this.breadcrumb||this.newBreadcrumb(),this.breadcrumb.items.length<=1?"":this.breadcrumb.items[this.breadcrumb.items.length-2].link},e.prototype.hasPreviousRouter=function(){return this.breadcrumb.items.length>1},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}();var f=function(){function e(){}return e.prototype.callProgress=function(e){parent.postMessage({program:e},"*")},e.prototype.sendNotification=function(e){parent.postMessage({notification:e},"*")},e.prototype.openPath=function(e,t,r){void 0===r&&(r=!0);var n=window.location.href.indexOf("totvs-menu")>0?"totvs-menu":"menu-html",o="/"+n+"/#/"+n+"/program-html/"+e+"/#";r?window.open(o+"/"+t,"_parent"):window.open(o+"/"+t)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}(),v=function(){function e(){this.values={}}return e.prototype.setValue=function(e,t){this.values[e]=t},e.prototype.getValue=function(e){return this.values[e]},e.prototype.removeValue=function(e){delete this.values[e]},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var y=function(){function e(){}return e.dateToQueryParam=function(e){var t=e.getDate(),r=e.getMonth()+1;return e.getFullYear()+"-"+this.pad(r)+"-"+this.pad(t)},e.queryParamToDate=function(e){var t=+e.split("-")[2],r=+e.split("-")[1],n=+e.split("-")[0];return new Date(n,r-1,t)},e.isValidDate=function(e){return e instanceof Date&&!isNaN(e.getTime())},e.ajustDate=function(e){return e instanceof Date?e:e?this.queryParamToDate(e.split("T")[0]):e},e.ajustDateToModel=function(e,t){if(void 0===e&&(e={}),e.hasOwnProperty(t)&&e[t]){if(e[t].indexOf("T")>=0)return new Date(e[t]);var r=+e[t].split("-")[2],n=+e[t].split("-")[1],o=+e[t].split("-")[0];return new Date(o,n-1,r)}return null},e.pad=function(e){return e<10?"0"+e:e},e}(),g=function(){function e(e,t,r){this.literals={},this.poNotification=e,this.poI18nPipe=t,this.literals=r}return e.prototype.makeDisclaimer=function(e,t,r,n,o){return void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),null==t||o&&""===t?{label:"",property:"",value:""}:{hideClose:r,label:this.literals[e]+": "+(n?this.literals[t]:t),property:""+e,value:""+t}},e.prototype.makeDisclaimerFromNumber=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),null==t||n&&0===t?{label:"",property:"",value:""}:{hideClose:r,label:this.literals[e]+": "+t,property:""+e,value:""+t}},e.prototype.makeDisclaimerFromBoolean=function(e,t,r){return void 0===r&&(r=!1),null==t?{label:"",property:"",value:""}:{hideClose:r,label:this.literals[e]+": "+(t?this.literals.yes:this.literals.no),property:""+e,value:""+t}},e.prototype.makeDisclaimerFromDate=function(e,t,r){void 0===r&&(r=!1);var n=this.ajustDate(t);return this.isValidDate(n)?{hideClose:r,label:this.literals[e]+": "+n.toLocaleDateString(),property:""+e,value:""+this.dateToQueryParam(n)}:{label:"",property:"",value:""}},e.prototype.makeDisclaimerFromMultiSelect=function(e,t,r,n,o){var i=this;void 0===r&&(r=0),void 0===n&&(n=!1),void 0===o&&(o=!1);var a="",l="";return t?(0===t.length||r>0&&t.length===r?(a=this.literals.all,l="all"):t.map((function(e){""!==a&&(a+=", "),""!==l&&(l+=","),a=""+a+(o?i.literals[e]:e),l=""+l+e})),{hideClose:n,label:this.literals[e]+": "+a,property:""+e,value:""+l}):{label:"",property:"",value:""}},e.prototype.makeDisclaimerFromCheckboxGroup=function(e,t,r,n){var o=this;void 0===r&&(r=0),void 0===n&&(n=!1);var i="",a="";return t?(0===t.length?(i=this.literals.none,a="none"):r>0&&t.length===r?(i=this.literals.all,a="all"):t.map((function(e){""!==i&&(i+=", "),""!==a&&(a+=","),i=""+i+o.literals[e],a=""+a+e})),{hideClose:n,label:this.literals[e]+": "+i,property:""+e,value:""+a}):{label:"",property:"",value:""}},e.prototype.makeDisclaimerFromRangeCharacter=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!0),null!==t.valInitial&&void 0!==t.valInitial||(t.valInitial=t.iniInitial),null!==t.valFinal&&void 0!==t.valFinal||(t.valFinal=t.iniFinal),n&&t.iniInitial===t.valInitial&&t.iniFinal===t.valFinal?{label:"",property:"",value:""}:{hideClose:r,label:this.poI18nPipe.transform(this.literals.filterRange,[this.literals[e],"'"+t.valInitial+"'","'"+t.valFinal+"'"]),property:""+e,value:t.valInitial+";"+t.valFinal}},e.prototype.makeDisclaimerFromRangeNumber=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!0),null!==t.valInitial&&void 0!==t.valInitial||(t.valInitial=t.iniInitial),null!==t.valFinal&&void 0!==t.valFinal||(t.valFinal=t.iniFinal),n&&t.iniInitial===t.valInitial&&t.iniFinal===t.valFinal?{label:"",property:"",value:""}:{hideClose:r,label:this.poI18nPipe.transform(this.literals.filterRange,[this.literals[e],t.valInitial,t.valFinal]),property:""+e,value:t.valInitial+";"+t.valFinal}},e.prototype.makeDisclaimerFromRangeDate=function(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!0);var o=this.ajustDate(t.valInitial),i=this.ajustDate(t.valFinal);return this.isValidDate(o)||(o=t.iniInitial,t.valInitial=t.iniInitial),this.isValidDate(i)||(i=t.iniFinal,t.valFinal=t.iniFinal),n&&this.dateToQueryParam(t.iniInitial)===this.dateToQueryParam(o)&&this.dateToQueryParam(t.iniFinal)===this.dateToQueryParam(i)?{label:"",property:"",value:""}:{hideClose:r,label:this.poI18nPipe.transform(this.literals.filterRange,[this.literals[e],o.toLocaleDateString(),i.toLocaleDateString()]),property:""+e,value:this.dateToQueryParam(o)+";"+this.dateToQueryParam(i)}},e.prototype.atzCharFromDisclamer=function(e,t,r){var n=r;return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(n=e.value,!0))})),n},e.prototype.atzNumberFromDisclamer=function(e,t,r){var n=r;return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(n=e.value,!0))})),n},e.prototype.atzBooleanFromDisclamer=function(e,t,r){var n=r;if(e&&e.length>0){var o=e.find((function(e){return e.property===t}));if(o&&null!==o.value&&void 0!==o.value)return"true"===o.value}return n},e.prototype.atzDateFromDisclamer=function(e,t,r){var n=this,o=this.ajustDate(r);return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(o=n.ajustDate(e.value),!0))})),o},e.prototype.atzMultiSelectCharFromDisclamer=function(e,t,r){return this.atzMultiSelectFromDisclamer("char",e,t,r)},e.prototype.atzMultiSelectNumberFromDisclamer=function(e,t,r){return this.atzMultiSelectFromDisclamer("number",e,t,r)},e.prototype.atzMultiSelectFromDisclamer=function(e,t,r,n){var o=[];return n.map((function(e){o.push(e.value)})),t&&t.length>0&&t.find((function(t){return t.property===r&&(null!==t.value&&"all"!==t.value&&"none"!==t.value&&(o=[],t.value.split(",").forEach((function(t){"char"===e&&o.push(t),"number"===e&&o.push(+t)})),!0))})),o},e.prototype.atzCheckboxFromDisclamer=function(e,t,r){var n=[];return r.map((function(e){n.push(e.value)})),e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&"all"!==e.value&&"none"!==e.value&&(n=[],e.value.split(",").forEach((function(e){n.push(e)})),!0))})),n},e.prototype.atzRangeCharFromDisclamer=function(e,t,r){var n="";return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(n=e.value,!0))})),this.atzRangeCharFromQueryParam(n,r)},e.prototype.atzRangeNumFromDisclamer=function(e,t,r){var n="";return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(n=e.value,!0))})),this.atzRangeNumFromQueryParam(n,r)},e.prototype.atzRangeDateFromDisclamer=function(e,t,r){var n="";return e&&e.length>0&&e.find((function(e){return e.property===t&&(null!==e.value&&(n=e.value,!0))})),this.atzRangeDateFromQueryParam(n,r)},e.prototype.atzRangeCharFromQueryParam=function(e,t){return t.valInitial=t.iniInitial,t.valFinal=t.iniFinal,e&&""!==e?(t.valInitial=e.split(";")[0],t.valFinal=e.split(";")[1],null!==t.valFinal&&void 0!==t.valFinal||(t.valFinal=t.iniFinal),t):t},e.prototype.atzRangeNumFromQueryParam=function(e,t){return t.valInitial=t.iniInitial,t.valFinal=t.iniFinal,e&&""!==e?(t.valInitial=+e.split(";")[0],t.valFinal=+e.split(";")[1],null!==t.valFinal&&void 0!==t.valFinal||(t.valFinal=t.iniFinal),t):t},e.prototype.atzRangeDateFromQueryParam=function(e,t){return t.valInitial=t.iniInitial,t.valFinal=t.iniFinal,e&&""!==e?(t.valInitial=this.queryParamToDate(e.split(";")[0]),t.valFinal=this.queryParamToDate(e.split(";")[1]),null!==t.valFinal&&void 0!==t.valFinal||(t.valFinal=t.iniFinal),t):t},e.prototype.dateToQueryParam=function(e){var t=e.getDate(),r=e.getMonth()+1;return e.getFullYear()+"-"+this.pad(r)+"-"+this.pad(t)},e.prototype.queryParamToDate=function(e){var t=+e.split("-")[2],r=+e.split("-")[1],n=+e.split("-")[0];return new Date(n,r-1,t)},e.prototype.isValidDate=function(e){return e instanceof Date&&!isNaN(e.getTime())},e.prototype.ajustDate=function(e){return e instanceof Date?e:e?this.queryParamToDate(e.split("T")[0]):e},e.prototype.pad=function(e){return e<10?"0"+e:e},e}();var b=function(){function e(e,t,r){this.literals={},this.poNotification=e,this.poI18nPipe=t,this.literals=r,this.disclaimerUtil=new g(this.poNotification,this.poI18nPipe,this.literals)}return e.prototype.vldFieldCharacter=function(e,t){return!(!t||""===t.trim())||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldRequered,[this.literals[e]])}),!1)},e.prototype.vldRangeCharacter=function(e,t,r,n){return!r||!n||(!(r.trim().toUpperCase()>n.trim().toUpperCase())||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldRange,[this.literals[e],this.literals[t]])}),!1))},e.prototype.vldFieldNumber=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),!(r&&!this.vldValueOfNumber(e,t))&&(!(!t||t<=0)||(0===t&&!0===n||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldRequered,[this.literals[e]])}),!1)))},e.prototype.vldValueOfNumber=function(e,t){return!(t&&t<0)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldNumber,[t.toString(),this.literals[e]])}),!1)},e.prototype.vldFieldPercent=function(e,t,r){return void 0===r&&(r=!1),!(r&&!this.vldValueOfPercent(e,t))&&!!this.vldFieldNumber(e,t)},e.prototype.vldValueOfPercent=function(e,t){return t&&t<0?(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldNumber,[t.toString(),this.literals[e]])}),!1):!(t&&t>100)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldNumber,[t.toString(),this.literals[e]])}),!1)},e.prototype.vldRangeNumber=function(e,t,r,n){return r||(r=0),n||(n=0),!(r>n)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldRange,[this.literals[e],this.literals[t]])}),!1)},e.prototype.vldFieldDate=function(e,t){var r=this.disclaimerUtil.ajustDate(t);return!!this.disclaimerUtil.isValidDate(r)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldDate,[this.literals[e]])}),!1)},e.prototype.vldRangeDate=function(e,t,r,n){return!r||!n||(!(this.disclaimerUtil.ajustDate(r).getTime()>this.disclaimerUtil.ajustDate(n).getTime())||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldRange,[this.literals[e],this.literals[t]])}),!1))},e.prototype.vldFieldMultiSelect=function(e,t){return!(!t||0===t.length)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldSelected,[this.literals[e]])}),!1)},e.prototype.vldFieldCheckbox=function(e,t){return!(!t||0===t.length)||(this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldSelected,[this.literals[e]])}),!1)},e.prototype.vldFieldFormat=function(e,t,r,n){void 0===n&&(n=!1);var o,i=!0;if(!t)return i;if(n&&(o=r,r=r.replace(/\./g,"")),t.length!==r.length)i=!1;else for(var a=0;a<r.length;a++){if("9"===r[a]&&"9"!==t[a].replace(/[0-9]/,"9")){i=!1;break}if("!"===r[a]&&"A"!==t[a].replace(/[A-Z]/,"A")){i=!1;break}}return n&&(r=o),i||this.poNotification.error({message:this.poI18nPipe.transform(this.literals.fieldVldFormat,[this.literals[e],r])}),i},e}();var x=function(){function e(){}return e.makeFilterRangeCharacter=function(e,t){return{iniInitial:e,iniFinal:t,valInitial:e,valFinal:t}},e.makeFilterRangeNumber=function(e,t){return{iniInitial:e,iniFinal:t,valInitial:e,valFinal:t}},e.makeFilterRangeDate=function(e,t){return{iniInitial:e,iniFinal:t,valInitial:e,valFinal:t}},e}();var F=function(){function e(e){this.literals={},this.literals=e}return e.listToArrayCharacter=function(e){var t=new Array;return e&&""!==e&&(t=e.split(",")),t},e.ArrayToListCharacter=function(e){var t="";return e&&e.length>0&&(t=e.join(",")),t},e.isEmpty=function(e){var t=!0;for(var r in e)e.hasOwnProperty(r)&&(t=!1);return t},e.getChartValues=function(e){var t,r,n;(r=void 0,n=void 0,e.map((function(e){void 0===r&&void 0===n?(r=e.data[0],n=e.data[0]):(e.data<n&&(n=e.data[0]),e.data>r&&(r=e.data[0]))})),r>0&&n>0&&(t={maxValue:r,minValue:0}),r>0&&n<0&&(t={maxValue:r,minValue:n}),r<0&&n<0)&&(t={maxValue:n/3*-1,minValue:n});(r>0&&0===n&&(t={maxValue:r,minValue:0}),0===r&&n<0)&&(t={maxValue:n/3*-1,minValue:n});return 0===r&&0===n&&(t={maxValue:void 0,minValue:void 0}),t.maxValue=Math.round(t.maxValue),t.minValue=Math.round(t.minValue),t},e.atzMultiSelectListByOptions=function(e,t){var r;return t?(r=new Array,t.map((function(t){t&&e.findIndex((function(e){return e.value===t}))>=0&&r.push(t)})),r):t},e.prototype.loadOptionsMultiSelect=function(e,t){var r=this;t&&t.map((function(t){t&&-1===e.findIndex((function(e){return e.value===t}))&&e.push({label:"all"===t?r.literals.all:t,value:t})}))},e.prototype.loadOptionsSelect=function(e,t,r){void 0===r&&(r=!1),t&&t&&-1===e.findIndex((function(e){return e.value===t}))&&e.push({label:r?this.literals[t]:t,value:t})},e.prototype.compareObjects=function(e,t){if(!e||!t)return!1;if(Object.getOwnPropertyNames(e).length!==Object.getOwnPropertyNames(t).length)return!1;for(var r in e)if("$"!==r.substr(0,1)&&"_"!==r.substr(0,1)&&e[r]!==t[r])return!1;return!0},e.prototype.referenceGeneration=function(e,t){var r,n=t.getDate(),o=t.getMonth()+1,i=t.getFullYear();return""+(""+this.pad(i)+this.pad(o)+this.pad(n)+e)+(r=(r=(r=btoa(""+(new Date).getTime())).replace(/[=]/g,"")).slice(r.length-3,r.length))},e.prototype.pad=function(e){return e<10?"0"+e:e>99?(e+"").slice(2,4):e},e}();var I=function(){};var D=function(){function e(e){this.http=e,this.apiUrl="/dts/datasul-rest/resources/prg/cdp/v1/genericsZoom",this.urlJobScheduler="/dts/datasul-rest/resources/prg/framework/v1/jobScheduler",this.filterRpw={fields:"cod_servid_exec,des_servid_exec",filter:"cod_servid_exec",filterZoom:"cod_servid_exec",order:"cod_servid_exec",table:"servid_exec"}}return e.prototype.getFilteredData=function(e,t){var r=this,n=Object.assign({},this.filterRpw),o=this.apiUrl+"?pageSize=10&page=1&table="+n.table;return o+="&fields="+n.fields+"&order="+n.order,e.value&&(o+="&"+n.filterZoom+"=*"+e.value+"*"),this.http.get(o,{}).pipe(p.map((function(e){return r.convertToArrayComboOption(e.items,"codServidExec","desServidExec")})))},e.prototype.getObjectByValue=function(e){var t=this;return this.http.get(this.apiUrl+"/"+e).pipe(p.map((function(e){return t.convertToThfComboOption(e,"codServidExec","desServidExec")})))},e.prototype.createRpw=function(e){var t=JSON.parse(JSON.stringify(e).replace(/\\\\/g,"*|"));return this.http.post(""+this.urlJobScheduler,t)},e.prototype.convertToArrayComboOption=function(e,t,r){var n=this;return e&&e.length>0?e.map((function(e){return n.convertToThfComboOption(e,t,r)})):[]},e.prototype.convertToThfComboOption=function(e,t,r){return{value:(e=e||{})[t]||void 0,label:e[r]||void 0}},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:r.HttpClient}]},e}();var O=function(){function e(e,r,n){this.thfI18nService=e,this.rpwService=r,this.poNotification=n,this.programEMS5=!1,this.programVersion="",this.endExecution=new t.EventEmitter,this.jsonObject={},this.literals={}}return e.prototype.ngOnInit=function(){this.setupComponents()},e.prototype.setupComponents=function(){this.executionTypeOptions=[{label:"Executar Hoje",value:1},{label:"Agendar Execução",value:2}],this.frequencyOptions=[{label:"Uma vez no dia",value:"no"},{label:"Várias vezes no dia",value:"yes"}],this.frequencyTypeOptions=[{label:"Hora(s)",value:"hour"},{label:"Minuto(s)",value:"minute"}],this.weeklyOptions=[{label:"Domingo",value:"Sunday"},{label:"Segunda",value:"Monday"},{label:"Terça",value:"Tuesday"},{label:"Quarta",value:"Wednesday"},{label:"Quinta",value:"Thursday"},{label:"Sexta",value:"Friday"},{label:"Sábado",value:"Saturday"}],this.columns=[{property:"cod_servid_exec",label:"Código"},{property:"des_servid_exec",label:"Descrição"}],this.model=new I,this.model.executionType=1,this.model.activeTab=1,this.model.repeatExecution=!1},e.prototype.isExecutionSchedule=function(){return 2===this.model.executionType},e.prototype.isRepeatExecution=function(){return this.model.repeatExecution},e.prototype.isFrenquency=function(){return"yes"===this.model.frequency},e.prototype.changeRepeatExecution=function(){var e=new Date;this.model.execAppointHourInit=this.addZero(e.getHours())+":"+this.addZero(e.getMinutes()),this.model.execAppointHourFinal=this.addZero(e.getHours())+":"+this.addZero(e.getMinutes()),this.model.selectWeeklys=[],this.model.dayOfMonth=0,this.model.frequency="no",this.model.frequencyType="hour",this.model.frequencyValue=0},e.prototype.changeExecutionType=function(){var e=new Date;this.model.execAppointDate=e,this.model.execAppointHour=this.addZero(e.getHours())+":"+this.addZero(e.getMinutes())},e.prototype.changeTypeFrequency=function(){},e.prototype.setActiveTab=function(e){this.model.activeTab=e},e.prototype.addZero=function(e){return e<10&&(e="0"+e),e},e.prototype.executeSchedule=function(){var e=this;if(this.validate()){if(this.jsonObject={},this.jsonObject.status="active",this.jsonObject.processID=this.programName,this.jsonObject.recurrent=this.model.repeatExecution,this.jsonObject.executionParameter={},1===this.model.executionType){var t=new Date;this.jsonObject.firstExecution=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"T"+this.addZero(t.getHours())+":"+this.addZero(t.getMinutes())+":00.000Z"}2===this.model.executionType&&(this.jsonObject.firstExecution=this.model.execAppointDate+"T"+this.model.execAppointHour+":00.000Z"),this.jsonObject.executionParameter.parametros=[],this.jsonObject.executionParameter.parametros[0]={chave:"rpwServer",valor:this.model.executionServer},this.jsonObject.executionParameter.parametros[1]={chave:"RPW_PROGRAM",valor:this.externalName},this.jsonObject.executionParameter.parametros[2]={chave:"RPW_PRG_EMS5",valor:this.programEMS5?"yes":"no"},this.jsonObject.executionParameter.parametros[3]={chave:"RPW_PRG_VERS",valor:this.programVersion},this.jsonObject.executionParameter.parametros[4]={},this.jsonObject.executionParameter.parametros[4].parametros_negocio=this.parameters,this.rpwService.createRpw(this.jsonObject).subscribe((function(){e.poNotification.success("Execução efetuada com sucesso !")})),this.model.repeatExecution&&(1===this.model.activeTab&&(this.jsonObject.daily={hour:this.getHourOrMinute(this.model.execAppointHourInit,"h"),minute:this.getHourOrMinute(this.model.execAppointHourInit,"m")}),2===this.model.activeTab&&(this.jsonObject.weekly={hour:this.getHourOrMinute(this.model.execAppointHourInit,"h"),minute:this.getHourOrMinute(this.model.execAppointHourInit,"m"),daysOfWeek:this.model.selectWeeklys}),3===this.model.activeTab&&(this.jsonObject.monthly={hour:this.getHourOrMinute(this.model.execAppointHourInit,"h"),minute:this.getHourOrMinute(this.model.execAppointHourInit,"m"),day:this.model.dayOfMonth}),this.isFrenquency()&&(this.jsonObject.rangeExecutions={frequency:{type:this.model.frequencyType,value:this.model.frequencyValue},rangeLimit:{hour:this.getHourOrMinute(this.model.execAppointHourFinal,"h"),minute:this.getHourOrMinute(this.model.execAppointHourFinal,"m")}}),this.rpwService.createRpw(this.jsonObject).subscribe((function(){}))),this.endExecution.emit("endExecution")}},e.prototype.getHourOrMinute=function(e,t){return"h"===t?+e.substring(0,2):"m"===t?+e.substring(3,6):void 0},e.prototype.compareHour=function(e,t){return e!==t&&(this.getHourOrMinute(e,"h")<this.getHourOrMinute(t,"h")||!(this.getHourOrMinute(e,"m")>this.getHourOrMinute(t,"m")))},e.prototype.validate=function(){if(!this.scheduleExecutionForm.valid)return this.poNotification.error("Verifique as inconsistências em tela."),!1;if(!this.model.executionServer)return this.poNotification.error("Servidor de Execução não foi informado."),!1;if(this.isExecutionSchedule()&&(!this.model.execAppointDate||!this.model.execAppointHour))return this.poNotification.error("Informar a data e a hora para agendamento da execução."),!1;if(this.model.repeatExecution){if(!this.model.execAppointHourInit)return this.poNotification.error("Informar a hora de início para a execução."),!1;if(2===this.model.activeTab&&0===this.model.selectWeeklys.length)return this.poNotification.error("Informar os dias da semana para a execução."),!1;if(3===this.model.activeTab&&!this.model.dayOfMonth)return this.poNotification.error("Informar o dia para a execução."),!1;if(this.isFrenquency()){if(!this.compareHour(this.model.execAppointHourInit,this.model.execAppointHourFinal))return this.poNotification.error("Hora Fim deve ser maior que Hora Início."),!1;if(0===this.model.frequencyValue)return this.poNotification.error("Informar a frequência de execução (A cada hora/minuto)."),!1}}return!0},e.decorators=[{type:t.Component,args:[{selector:"app-totvs-schedule-execution",template:'<form #scheduleExecutionForm="ngForm">\r\n    <div class="po-row po-sm-12 po-md-12 po-lg-12 po-xl-12">\r\n        <po-radio-group \r\n            class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n            name="executionType"\r\n            p-label="Data de Execução"\r\n            [(ngModel)]="model.executionType"\r\n            [p-options]="executionTypeOptions"\r\n            (p-change)="changeExecutionType()">\r\n        </po-radio-group>\r\n\r\n        <po-datepicker *ngIf=isExecutionSchedule()\r\n            class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n            name="model.execAppointDate"\r\n            p-label="Agendar para"\r\n            [(ngModel)]="model.execAppointDate">\r\n        </po-datepicker>\r\n\r\n        <po-input *ngIf=isExecutionSchedule()\r\n            class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n            name="execAppointHour"\r\n            p-label="Hora"\r\n            p-mask="99:99"\r\n            p-mask-format-model="true"\r\n            p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n            p-error-pattern="Hora inválida"\r\n            [(ngModel)]="model.execAppointHour">\r\n        </po-input>\r\n    </div>\r\n\r\n    <div class="po-row po-sm-12 po-md-12 po-lg-12 po-xl-12">\r\n        <po-combo\r\n            class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n            name="executionServer"\r\n            p-field-label="des_servid_exec"\r\n            p-field-value="cod_servid_exec"\r\n            p-label="Servidor de Execução"\r\n            p-placeholder="Servidor de Execucão"\r\n            [(ngModel)]="model.executionServer"\r\n            [p-filter-service]="rpwService">\r\n        </po-combo>\r\n    </div>\r\n\r\n    <div class="po-row po-sm-12 po-md-12 po-lg-12 po-xl-12">\r\n        <po-switch\r\n            class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n            name="repeatExecution"\r\n            p-label="Repetir ocorrência ?"\r\n            p-label-off="Não"\r\n            p-label-on="Sim"\r\n            [(ngModel)]="model.repeatExecution"\r\n            (click)="changeRepeatExecution()">\r\n        </po-switch>\r\n    </div>\r\n\r\n    <div class="po-row" *ngIf="isRepeatExecution()">\r\n        <po-tabs>\r\n            <po-tab p-label="Diária" p-active (p-click)="setActiveTab(1)">\r\n                <div class="po-sm-6 po-md-6 po-lg-6 po-xl-6">\r\n                    <po-radio-group \r\n                        class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n                        name="frequencyDaily"\r\n                        p-label="Frequência"\r\n                        p-columns=1\r\n                        [(ngModel)]="model.frequency"\r\n                        [p-options]="frequencyOptions"\r\n                        (p-change)="changeTypeFrequency()">\r\n                    </po-radio-group>\r\n                </div>\r\n\r\n                <div class="po-sm-6 po-md-6 po-lg-6 po-xl-6">    \r\n                    <po-input\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourInitDaily"\r\n                        p-label="Hora Início"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourInit">\r\n                    </po-input>\r\n\r\n                    <po-input *ngIf="isFrenquency()"\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourFinalDaily"\r\n                        p-label="Hora Fim"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourFinal">\r\n                    </po-input>\r\n\r\n                    <po-number *ngIf="isFrenquency()"\r\n                        class="po-sm-5 po-md-5 po-lg-5 po-xl-5"\r\n                        name="frequencyValueDaily"\r\n                        p-label="A cada"\r\n                        p-minlength="1"\r\n                        p-maxlength="3"\r\n                        p-min="0"\r\n                        p-max="999"\r\n                        [(ngModel)]="model.frequencyValue">\r\n                    </po-number>\r\n\r\n                    <po-select *ngIf="isFrenquency()"\r\n                        class="po-mt-3 po-sm-7 po-md-7 po-lg-7 po-xl-7"\r\n                        name="frequencyTypeDaily"\r\n                        p-label=""\r\n                        [p-options]="frequencyTypeOptions"\r\n                        [(ngModel)]="model.frequencyType">\r\n                    </po-select>\r\n                </div>\r\n            </po-tab>\r\n\r\n            <po-tab p-label="Semanal" (p-click)="setActiveTab(2)">\r\n                <div class="po-row po-sm-12 po-md-12 po-lg-12 po-xl-12">\r\n                    <po-multiselect\r\n                        class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n                        name="selectWeeklys"\r\n                        p-label="Dias da Semana"\r\n                        p-placeholder="Escolha os dias da semana"\r\n                        [(ngModel)]="model.selectWeeklys"\r\n                        [p-options]="weeklyOptions">\r\n                    </po-multiselect>\r\n                </div>\r\n\r\n                <div class="po-sm-6 po-md-6 po-lg-6 po-xl-6">\r\n                    <po-radio-group \r\n                        class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n                        name="frequencyWeekly"\r\n                        p-label="Frequência"\r\n                        p-columns=1\r\n                        [(ngModel)]="model.frequency"\r\n                        [p-options]="frequencyOptions"\r\n                        (p-change)="changeTypeFrequency()">\r\n                    </po-radio-group>\r\n                </div>\r\n\r\n                <div class="po-sm-6 po-md-6 po-lg-6 po-xl-6">\r\n                    <po-input\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourInitWeekly"\r\n                        p-label="Hora Início"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourInit">\r\n                    </po-input>\r\n\r\n                    <po-input *ngIf="isFrenquency()"\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourFinalWeekly"\r\n                        p-label="Hora Fim"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourFinal">\r\n                    </po-input>\r\n\r\n                    <po-number *ngIf="isFrenquency()"\r\n                        class="po-sm-5 po-md-5 po-lg-5 po-xl-5"\r\n                        name="frequencyValueWeekly"\r\n                        p-label="A cada"\r\n                        p-minlength="1"\r\n                        p-maxlength="3"\r\n                        p-min="0"\r\n                        p-max="999"\r\n                        [(ngModel)]="model.frequencyValue">\r\n                    </po-number>\r\n\r\n                    <po-select *ngIf="isFrenquency()"\r\n                        class="po-mt-3 po-sm-7 po-md-7 po-lg-7 po-xl-7"\r\n                        name="frequencyTypeWeekly"\r\n                        p-label=""\r\n                        [p-options]="frequencyTypeOptions"\r\n                        [(ngModel)]="model.frequencyType">\r\n                    </po-select>\r\n                </div>\r\n            </po-tab>\r\n\r\n            <po-tab p-label="Mensal" (p-click)="setActiveTab(3)">\r\n                <div class="po-row po-sm-12 po-md-12 po-lg-12 po-xl-12">\r\n                    <po-number\r\n                        class="po-sm-3 po-md-3 po-lg-3 po-xl-3"\r\n                        name="dayOfMonth"\r\n                        p-label="Dia do mês"\r\n                        p-minlength="1"\r\n                        p-maxlength="2"\r\n                        p-min="0"\r\n                        p-max="31"\r\n                        [(ngModel)]="model.dayOfMonth">\r\n                    </po-number>\r\n                </div>\r\n\r\n                <div class="po-row po-sm-6 po-md-6 po-lg-6 po-xl-6">\r\n                    <po-radio-group \r\n                        class="po-sm-12 po-md-12 po-lg-12 po-xl-12"\r\n                        name="frequencyMonthly"\r\n                        p-label="Frequência"\r\n                        p-columns=1\r\n                        [(ngModel)]="model.frequency"\r\n                        [p-options]="frequencyOptions"\r\n                        (p-change)="changeTypeFrequency()">\r\n                    </po-radio-group>\r\n                </div>\r\n\r\n                 <div class="po-row po-sm-6 po-md-6 po-lg-6 po-xl-6">\r\n                    <po-input\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourInitMonthly"\r\n                        p-label="Hora Início"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourInit">\r\n                    </po-input>\r\n\r\n                    <po-input *ngIf="isFrenquency()"\r\n                        class="po-sm-6 po-md-6 po-lg-6 po-xl-6"\r\n                        name="execAppointHourFinalWeekly"\r\n                        p-label="Hora Fim"\r\n                        p-mask="99:99"\r\n                        p-mask-format-model="true"\r\n                        p-pattern="^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$"\r\n                        p-error-pattern="Hora inválida"\r\n                        [(ngModel)]="model.execAppointHourFinal">\r\n                    </po-input>\r\n\r\n                    <po-number *ngIf="isFrenquency()"\r\n                        class="po-sm-5 po-md-5 po-lg-5 po-xl-5"\r\n                        name="frequencyValueWeekly"\r\n                        p-label="A cada"\r\n                        p-minlength="1"\r\n                        p-maxlength="3"\r\n                        p-min="0"\r\n                        p-max="999"\r\n                        [(ngModel)]="model.frequencyValue">\r\n                    </po-number>\r\n\r\n                    <po-select *ngIf="isFrenquency()"\r\n                        class="po-mt-3 po-sm-7 po-md-7 po-lg-7 po-xl-7"\r\n                        name="frequencyTypeWeekly"\r\n                        p-label=""\r\n                        [p-options]="frequencyTypeOptions"\r\n                        [(ngModel)]="model.frequencyType">\r\n                    </po-select>\r\n                </div>\r\n            </po-tab>\r\n        </po-tabs>\r\n    </div>\r\n\r\n    <div class="po-sm-12 po-md-12 po-lg-12 po-xl-12" style="padding-top: 15px;">\r\n        <po-button\r\n            style="float: right;"\r\n            p-label="Gerar Agendamento RPW"\r\n            (click)="executeSchedule()">\r\n        </po-button>\r\n    </div>\r\n</form>\r\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:a.PoI18nService},{type:D},{type:a.PoNotificationService}]},e.propDecorators={scheduleExecutionForm:[{type:t.ViewChild,args:["scheduleExecutionForm",{static:!0}]}],programName:[{type:t.Input}],externalName:[{type:t.Input}],programEMS5:[{type:t.Input}],programVersion:[{type:t.Input}],parameters:[{type:t.Input}],endExecution:[{type:t.Output}]},e}();var P=function(){function e(){}return e.prototype.transform=function(e,t){void 0===t&&(t="dd/MM/yyyy");var r=e.split("-"),n=r[0],o=r[1],i=r[2];return t.replace("dd",i).replace("MM",o).replace("yyyy",n)},e.decorators=[{type:t.Pipe,args:[{name:"dtsDateFormat"}]}],e}(),S=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[D]}},e.decorators=[{type:t.NgModule,args:[{declarations:[O,P],imports:[s.CommonModule,a.PoModule,l.FormsModule,r.HttpClientModule],exports:[O,P],providers:[D]}]}],e}();e.BreadcrumbControlService=h,e.CacheParamsService=v,e.DateUtil=y,e.DisclaimerUtil=g,e.DtsBackofficeUtilsModule=S,e.DtsDateFormatPipe=P,e.FieldValidationUtil=b,e.FilterRangeUtil=x,e.GenericFunctionsUtils=F,e.MenuDatasulService=f,e.ProfileService=d,e.ReportFormats={XLSX:"xlsx",PDF:"pdf",DOCX:"docx",HTML:"html"},e.ReportService=m,e.TotvsScheduleExecutionComponent=O,e.UserLoginService=u,e.ɵa=D,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=dts-backoffice-util.umd.min.js.map